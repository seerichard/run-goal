(this["webpackJsonprun-goal"]=this["webpackJsonprun-goal"]||[]).push([[0],{15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(0),a=n.n(r),o=n(8),i=n.n(o),s=(n(15),n(9)),u="cid",l="cs",h="at",f="rt",d=function(){var e=Object(s.a)(),t=e.register,n=e.errors,r=e.handleSubmit;return Object(c.jsxs)("form",{onSubmit:r((function(e){var t=e.clientId,n=e.clientSecret;localStorage.setItem(u,t),localStorage.setItem(l,n);var c=window.location.href;window.location.href="https://www.strava.com/oauth/authorize?client_id=".concat(t,"&redirect_uri=").concat(c,"&response_type=code&scope=activity:read_all")})),children:[Object(c.jsx)("label",{children:"Client Id"}),Object(c.jsx)("input",{name:"clientId",ref:t({required:!0})}),n.clientId&&"Please enter a Client Id",Object(c.jsx)("label",{children:"Client Secret"}),Object(c.jsx)("input",{name:"clientSecret",ref:t({required:!0})}),n.clientSecret&&"Please enter a Client Secret",Object(c.jsx)("button",{type:"submit",children:"Submit"})]})},g=n(1),p=n.n(g),m=n(3),j=function(e){var t=e.clientId,n=e.clientSecret,c=e.code;return"https://www.strava.com/oauth/token?client_id=".concat(t,"&client_secret=").concat(n,"&code=").concat(c,"&grant_type=authorization_code")},S=function(e){var t=e.clientId,n=e.clientSecret,c=e.refreshToken;return"https://www.strava.com/oauth/token?client_id=".concat(t,"&client_secret=").concat(n,"&refresh_token=").concat(c,"&grant_type=refresh_token")},b=function(e){var t=e.accessToken,n=Date.now()/1e3;return"https://www.strava.com/api/v3/athlete/activities?access_token=".concat(t,"&before=").concat(n,"&after=").concat(1609459200,"&per_page=200")},w=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,c,r,a,o,i,s,d,g,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem(u),c=localStorage.getItem(l),e.next=4,fetch(j({clientId:n,clientSecret:c,code:t}),{method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:a=e.sent,o=a.access_token,i=a.refresh_token,s=a.athlete,d=s.firstname,g=s.lastname,localStorage.setItem(h,o),localStorage.setItem(f,i),localStorage.setItem("fn",d),localStorage.setItem("ln",g),m=window.location.href,window.location.href=m.split("?")[0];case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(m.a)(p.a.mark((function e(){var t,n,c,r,a,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem(u),n=localStorage.getItem(l),c=localStorage.getItem(f),e.next=5,fetch(S({clientId:t,clientSecret:n,refreshToken:c}),{method:"POST"});case 5:return r=e.sent,e.next=8,r.json();case 8:a=e.sent,o=a.access_token,localStorage.setItem(h,o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(m.a)(p.a.mark((function e(){var t,n,c,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem(h),n="Run",e.next=4,fetch(b({accessToken:t}));case 4:return c=e.sent,e.next=7,c.json();case 7:return r=e.sent,a=r.filter((function(e){return e.type===n})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){var t=e.code;return Object(r.useEffect)((function(){w(t).catch((function(e){return console.log("Something happened fetching the token :(",e)}))}),[]),Object(c.jsx)("div",{children:"Token Fetcher Component"})},x=n(4),k=function(){var e=Object(r.useState)([]),t=Object(x.a)(e,2),n=t[0],a=t[1];Object(r.useEffect)((function(){v().catch((function(e){return console.log("Something happened refreshing the token :(",e)})),I().then((function(e){return a(e)})).catch((function(e){return console.log("Something happened getting activities :(",e)}))}),[]),console.log("runData:",n);var o=n.reduce((function(e,t){return e+t.distance}),0)/10,i=Math.round(o+100*Number.EPSILON)/100;return Object(c.jsxs)("div",{children:["Total Distance Run This Year: ",i,"km"]})},_=function(){var e=new URLSearchParams(window.location.search).get("code");return localStorage.getItem(f)?Object(c.jsx)(k,{}):e?Object(c.jsx)(O,{code:e}):Object(c.jsx)(d,{})},T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))};i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(_,{})}),document.getElementById("root")),T()}},[[17,1,2]]]);
//# sourceMappingURL=main.a4724894.chunk.js.map